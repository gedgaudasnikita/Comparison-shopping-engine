language: csharp
solution: Comparison-shopping-engine.sln

env:
  global:
    - GH_REPO_NAME: Comparison-shopping-engine
    - DOXYFILE: $TRAVIS_BUILD_DIR/Comparison-shopping-engine-documentation/Doxyfile
    - GH_REPO_REF: github.com/gedgaudasnikita/Comparison-shopping-engine.git

addons:
  apt:
    packages:
      - doxygen
      - doxygen-doc
      - doxygen-latex
      - doxygen-gui
      - graphviz

install:
  - nuget restore Comparison-shopping-engine.sln
  - nuget install NUnit.Runners -Version 3.7.0 -OutputDirectory testrunner
script:
  - xbuild /p:Configuration=CI Comparison-shopping-engine.sln
  - mono ./testrunner/NUnit.ConsoleRunner.3.7.0/tools/nunit3-console.exe ./Comparison-shopping-engine-backend.Tests/bin/CI/Comparison-shopping-engine-backend.Tests.dll
  - mono ./testrunner/NUnit.ConsoleRunner.3.7.0/tools/nunit3-console.exe ./Comparison-shopping-engine-core-entities.Tests/bin/CI/Comparison-shopping-engine-core-entities.Tests.dll
  - mono ./testrunner/NUnit.ConsoleRunner.3.7.0/tools/nunit3-console.exe ./Comparison-shopping-engine-web-protocol.Tests/bin/CI/Comparison-shopping-engine-web-protocol.Tests.dll
  - nuget install OpenCover -Version 4.6.519 -OutputDirectory $TRAVIS_BUILD_DIR/coveragerunner
  - nuget install ReportGenerator -Version 3.0.2 -OutputDirectory $TRAVIS_BUILD_DIR/coveragereporter

after_success:
  - cd $TRAVIS_BUILD_DIR
  - chmod +x Comparison-shopping-engine-documentation/build-doc.sh
  - Comparison-shopping-engine-documentation/build-doc.sh
